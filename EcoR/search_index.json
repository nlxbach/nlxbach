[["index.html", "X lý danh lc a dng sinh hc vi R Gii thiu", " X lý danh lc a dng sinh hc vi R Nguyn Lê Xuân Bách 2021-02-02 Gii thiu "],["thao-tác-c-b-n.html", "Chng 1 Thao tác c bn 1.1 Gii thiu d liu 1.2 M d liu 1.3 Thao tác c bn trên d liu 1.4 Thng kê s lng 1.5 Biu ", " Chng 1 Thao tác c bn 1.1 Gii thiu d liu Gii thiu b d liu Sn Trà  Tran BV, Le D, Hoang HQ, Hoang DM (2019) Occurrence data of terrestrial vertebrates of Son Tra Peninsula, Da Nang City, Vietnam. Biodiversity Data Journal 7: e39233. https://doi.org/10.3897/BDJ.7.e39233 1.2 M d liu S dng lnh read_csv() ca gói readr  m tp tin \"*.csv\" ã ti t ngun trên và lu vi tên sontra sontra &lt;- readr::read_csv(&quot;data/occurrence_SonTra_Peninsula_final.csv&quot;) 1.3 Thao tác c bn trên d liu Có nhiu package trong R dành cho vic thao tác trên d liu dng bng. Trong sách này chúng ta s dng gói dplyr mt phn ca h sinh thái tidyverse cho ni dung này. library(dplyr) 1.3.1 Xem s lng dòng và ct m s lng dòng và ct ca bng n gin vi lnh dim(). Ta c kt qu vi 900 hàng và 34 ct. Hoc ta có th s dng nrow() cho vic m s lng dòng, và ncol()  m s lng ct. dim(sontra) ## [1] 900 34 nrow(sontra) ## [1] 900 ncol(sontra) ## [1] 34 Ta có th xem danh sách tên ct ca bng vi lnh colnames(): colnames(sontra) ## [1] &quot;occurrenceID&quot; &quot;basisOfRecord&quot; ## [3] &quot;eventDate&quot; &quot;year&quot; ## [5] &quot;month&quot; &quot;day&quot; ## [7] &quot;verbatimEventDate&quot; &quot;scientificName&quot; ## [9] &quot;kingdom&quot; &quot;phylum&quot; ## [11] &quot;class&quot; &quot;order&quot; ## [13] &quot;family&quot; &quot;genus&quot; ## [15] &quot;specificEpithet&quot; &quot;taxonRank&quot; ## [17] &quot;scientificNameAuthorship&quot; &quot;identifiedBy&quot; ## [19] &quot;dateIdentified&quot; &quot;decimalLatitude&quot; ## [21] &quot;decimalLongitude&quot; &quot;geodeticDatum&quot; ## [23] &quot;verbatimCoordinateSystem&quot; &quot;continent&quot; ## [25] &quot;country&quot; &quot;countryCode&quot; ## [27] &quot;stateProvince&quot; &quot;county&quot; ## [29] &quot;locality&quot; &quot;language&quot; ## [31] &quot;institutionCode&quot; &quot;collectionCode&quot; ## [33] &quot;individualCount&quot; &quot;preparations&quot; 1.3.2 Ký hiu Pipes %&gt;% Trc khi xem các phn tip theo, chúng ta cn hiu ký hiu %&gt;%. ây là mt phong cách vit mã trong h sinh thái tidyverse. S dng ký hiu %&gt;% giúp trình bày rõ ràng hn các on mã dài có cha nhiu lnh ni tip nhau. Kt qu phn bên trái ký hiu s c xem là tham s u tiên ca lnh tip theo  bên phi ký hiu. Ví d:  m s dòng và ct ca b d liu Sn Trà  trên ta phi s dng 2 thao tác vi 2 lnh khác nhau sontra &lt;- readr::read_csv(&quot;data/occurrence_SonTra_Peninsula_final.csv&quot;) dim(sontra) # hoc dim(readr::read_csv(&quot;data/occurrence_SonTra_Peninsula_final.csv&quot;)) Ta có th s dng %&gt;%  trình bày trt t ca on mã nh sau: readr::read_csv(&quot;data/occurrence_SonTra_Peninsula_final.csv&quot;) %&gt;% dim() ## [1] 900 34 1.3.3 Lc d liu theo ct Bng d liu này cha nhiu trng thông tin mà chúng ta cha cn s dng. Ta có th to mt bng khác ch cha mt s ct mà chúng ta quan tâm vi lnh select(). Ta thc hin vic chn mt s ct và lu vào bng sontra2 nh sau: sontra2 &lt;- sontra %&gt;% select(class, order, family, genus, scientificName, year) dim(sontra2) ## [1] 900 6 Xem n dòng u tiên ca bng vi lnh head() sontra2 %&gt;% head(n = 5) class order family genus scientificName year Mammal Carnivora Herpestidae Herpestes Herpestes javanicus (É. Geoffroy Saint-Hilaire, 1818) 2016 Mammal Carnivora Herpestidae Herpestes Herpestes javanicus (É. Geoffroy Saint-Hilaire, 1818) 2016 Mammal Carnivora Herpestidae Herpestes Herpestes javanicus (É. Geoffroy Saint-Hilaire, 1818) 2017 Mammal Carnivora Herpestidae Herpestes Herpestes javanicus (É. Geoffroy Saint-Hilaire, 1818) 2017 Mammal Carnivora Herpestidae Herpestes Herpestes javanicus (É. Geoffroy Saint-Hilaire, 1818) 2017 Bên cnh vic nhp các tên ct, thì chúng ta có th nhp theo mt s cách sau: # Ly t ct &quot;class&quot; n ct &quot;genus&quot; sontra %&gt;% select(class:genus) %&gt;% head(5) class order family genus Mammal Carnivora Herpestidae Herpestes Mammal Carnivora Herpestidae Herpestes Mammal Carnivora Herpestidae Herpestes Mammal Carnivora Herpestidae Herpestes Mammal Carnivora Herpestidae Herpestes # Ly t ct th 11 n ct th 14 sontra %&gt;% select(11:14) %&gt;% head(5) class order family genus Mammal Carnivora Herpestidae Herpestes Mammal Carnivora Herpestidae Herpestes Mammal Carnivora Herpestidae Herpestes Mammal Carnivora Herpestidae Herpestes Mammal Carnivora Herpestidae Herpestes # Ly 6 ct u tiên nhng tr ct &quot;eventDate&quot; sontra %&gt;% select(1:6) %&gt;% select(-eventDate) %&gt;% head(5) occurrenceID basisOfRecord year month day B8945C0B-CB16-DC6E-B1E5-8C19749A44CC HumanObservation 2016 5 31 A9EB56E6-AA5C-C711-8CBE-A9EC25469327 HumanObservation 2016 10 20 A98E0AEC-3412-60E7-AC12-E4626E91D1D7 HumanObservation 2017 10 24 346612CE-7D29-BBC3-A5FA-84389D264AA9 HumanObservation 2017 10 21 B6537E98-E244-BCBC-9337-5C892F77B495 HumanObservation 2017 10 7 # Ly tt c các ct bt u bi ký t nào ó sontra %&gt;% select(starts_with(&quot;c&quot;)) %&gt;% head(5) class continent country countryCode county collectionCode Mammal Asia Vietnam VN Son Tra SIEZC Mammal Asia Vietnam VN Son Tra SIEZC Mammal Asia Vietnam VN Son Tra SIEZC Mammal Asia Vietnam VN Son Tra SIEZC Mammal Asia Vietnam VN Son Tra SIEZC # Ly tt c các ct có cha ký t nào ó sontra %&gt;% select(contains(&quot;Code&quot;)) %&gt;% head(5) countryCode institutionCode collectionCode VN SIE SIEZC VN SIE SIEZC VN SIE SIEZC VN SIE SIEZC VN SIE SIEZC 1.3.4 Trích lc theo dòng trong bng.  trích lc thông tin theo dòng trong bng ta s dng lnh filter() kt hp vi các ký hiu iu kin nh sau: x &lt; y: nh hn x &gt; y: ln hn x == y: bng hoc ging x &lt;= y: nh hn hoc bng y &gt;= y: ln hn hoc bng x != y: khác x %in% y: là mt phn t trong is.na(x): là NA !is.na(x): không là NA Ví d: Ta cn lc ra các dòng cha thông tin ca nhóm thú (Mammal) da trên ct class ca bng. sontra2 %&gt;% filter(class == &quot;Mammal&quot;) Kt qu ta thy có 128 dòng cha thông tin cho nhóm Thú. Ví d: Lc ra các ghi nhn ca c hai nhóm lng c (Amphibia) và bò sát (Reptilia). Ta kt hp thêm lnh %in% trong hàm filter() nh sau: sontra2 %&gt;% filter(class %in% c(&quot;Reptilia&quot;, &quot;Amphibia&quot;)) Kt qu ta có 327 dòng cha thông tin v hai nhóm Lng c và Bò sát trong b d liu. Ta cng có th s dng ký hiu &amp; (Và), | (Hoc)  a thêm vào các iu kin lc khác. Ví d ta cn quan tâm n các ghi nhn ca Lng c và Bò sát trong nm 2016: sontra2 %&gt;% filter(class %in% c(&quot;Reptilia&quot;, &quot;Amphibia&quot;) &amp; year == 2016) 1.3.5 Sp xp d liu Ta có th s dng lnh arrange()  sp xp d liu da trên các ct mà mình cn. Khi ó các dòng s c sp theo trt t bng ch cái i vi ch và t nh n ln i vi s. Ví d: sp bng theo trt t bng ch cái các Chi  ct genus: sontra2 %&gt;% filter(class %in% c(&quot;Reptilia&quot;, &quot;Amphibia&quot;) &amp; year == 2016) %&gt;% arrange(genus) Nu mun o chiu ta kt hp thêm lnh desc() nh sau: sontra2 %&gt;% filter(class %in% c(&quot;Reptilia&quot;, &quot;Amphibia&quot;) &amp; year == 2016) %&gt;% arrange(desc(genus)) 1.4 Thng kê s lng 1.4.1 dplyr  m s lng ghi nhn, s lng h, chi và loài trong b d liu ta có th s dng lnh summarise() vi cú pháp nh sau: lu ý: lnh n()  m tng s dòng, còn n_distinct()  m s dòng có giá tr khác nhau trong mt ct nào ó. sontra %&gt;% summarise( tong_so_ho = n_distinct(family), tong_so_chi = n_distinct(genus), tong_so_loai = n_distinct(scientificName), tong_so_ghi_nhan = n() ) tong_so_ho tong_so_chi tong_so_loai tong_so_ghi_nhan 63 121 144 900 Kt qu ta thy trong b d liu có tng cng 900 ghi nhn ca 144 loài, 121 chi và 63 h. Nu chúng ta mun thng kê tng t nhng cho tng nhóm Thú, Lng c, Bò sát và Chim thì kt hp thêm lnh group_by() nh sau: sontra %&gt;% group_by(class) %&gt;% summarise(tong_so_ho = n_distinct(family), tong_so_chi = n_distinct(genus), tong_so_loai = n_distinct(scientificName), tong_so_ghi_nhan = n()) class tong_so_ho tong_so_chi tong_so_loai tong_so_ghi_nhan Amphibia 6 13 16 182 Aves 35 67 82 445 Mammal 13 18 19 128 Reptilia 9 23 27 145 S lng ghi nhn, loài chi h ã c m theo tng nhóm. Bên cnh ó ta cng có th s dng lênh count()  m s ghi nhn theo nhóm ng vt nh sau: sontra %&gt;% count(class) class n Amphibia 182 Aves 445 Mammal 128 Reptilia 145 Hoc kt hp hàm arrange() và top_n()  tìm 5 loài có s ghi nhn nhiu nht sontra %&gt;% count(scientificName) %&gt;% arrange(desc(n)) %&gt;% top_n(n = 5) scientificName n Fejervarya limnocharis (Gravenhorst, 1829) 75 Pygathrix nemaeus (Linnaeus, 1771) 35 Limnonectes poilani (Bourret, 1942) 29 Cyrtodactylus pseudoquadrivirgatus Rösler, Nguyen, Vu, Ngo &amp; Ziegler, 2008 28 Physignathus cocincinus Cuvier, 1829 22 Kt qu loài Fejervarya limnocharis (Gravenhorst, 1829) c ghi nhn nhiu nht, lên n 75 ln. 1.4.2 bdvis #remotes::install_github(&quot;vijaybarve/bdvis&quot;) library(bdvis)  s dng các lnh t gói bdvis, ta cn phi i tên mt s ct quan trng ca bng sontra liên quan n tên khoa hc, thi gian và ta  ghi nhn ng thi chuyn nh dng sang nh dng bng ca gói này vi lnh format_bdvis(). sontra_bdvis &lt;- sontra %&gt;% rename( &quot;Latitude&quot; = &quot;decimalLatitude&quot;, &quot;Longitude&quot; = &quot;decimalLongitude&quot;, &quot;Date_collected&quot; = &quot;eventDate&quot;, &quot;Scientific_name&quot; = &quot;scientificName&quot;, &quot;Family&quot; = &quot;family&quot;, &quot;Genus&quot; = &quot;genus&quot;) %&gt;% format_bdvis() Khi ó  thng kê s lng ta gi lnh bdsummary(). Kt qu s tr v s ghi nhn, s lng H, Chi, Loài, thi gian ghi nhn trong b d liu. bdsummary(sontra_bdvis) ## ## Total no of records = 900 ## ## Temporal coverage... ## Date range of the records from 2016-01-10 to 2017-10-24 ## ## Taxonomic coverage... ## No of Families : 63 ## No of Genus : 121 ## No of Species : 144 ## ## Spatial coverage ... ## Bounding box of records 16.063 , 108.16 - 16.1535 , 108.3361 ## Degree celles covered : 1 ## % degree cells covered : Inf Ta cng có th xem thông tin cho các ghi nhn v nhóm Thú nh sau: sontra_bdvis %&gt;% filter(class == &quot;Mammal&quot;) %&gt;% bdsummary() ## ## Total no of records = 128 ## ## Temporal coverage... ## Date range of the records from 2016-05-28 to 2017-10-24 ## ## Taxonomic coverage... ## No of Families : 13 ## No of Genus : 18 ## No of Species : 19 ## ## Spatial coverage ... ## Bounding box of records 16.063 , 108.16 - 16.152 , 108.3361 ## Degree celles covered : 1 ## % degree cells covered : Inf 1.5 Biu  1.5.1 V nhanh mt s biu  vi gói bdvis 1.5.1.1 S lng ghi nhn theo ngày, tun, tháng trong nm par(mfrow = c(1,3)) tempolar(sontra_bdvis, color=&quot;red&quot;, title=&quot;Ghi nhn theo ngày&quot;, plottype=&quot;r&quot;, timescale=&quot;d&quot;) tempolar(sontra_bdvis, color=&quot;red&quot;, title=&quot;Ghi nhn theo tun&quot;, plottype=&quot;r&quot;, timescale=&quot;w&quot;) tempolar(sontra_bdvis, color=&quot;red&quot;, title=&quot;Ghi nhn theo tháng&quot;, plottype=&quot;r&quot;, timescale=&quot;m&quot;) 1.5.1.2 Calendarheat Biu  th hin s lng ghi nhn theo ngày. Trong ó mi ô vuông là 1 ngày, màu sc ca ô th hin s lng ghi nhn t ít n nhiu theo gam màu t  n xanh lá. bdcalendarheat(sontra_bdvis) 1.5.1.3 Chronohorogram - S lng ghi nhn tháng và nm Biu  này th hin s lng ghi nhn theo tháng và nm. Ta có th quy nh nm bt u và nm kt thúc s theo dõi. Khi ó tâm  th th hin cho nm bt u, sau ó mi nm tip theo c th hin bi 1 vòng tròn. Mt im th hin cho mt ngày ghi nhn d liu. Màu sc mc nh c th hin s ghi nhn trong ngày t ít n nhiu bng gam màu t xanh dng n . chronohorogram2 &lt;- function (indf = NA, title = &quot;Chronohorogram&quot;, startyear = 1980, endyear = NA, colors = c(&quot;red&quot;, &quot;blue&quot;), ptsize = 1) { if (!is.element(&quot;Date_collected&quot;, names(indf))) { stop(&quot;Field Date_collected not found in dataset \\n&quot;) } if (is.na(endyear)) { endyear = as.integer(format(Sys.Date(), &quot;%Y&quot;)) } dat1 = sqldf::sqldf(&quot;select Date_collected, count(*) as ct from indf group by Date_collected&quot;) if (is.na(dat1$Date_collected[1])) { dat1 = dat1[2:dim(dat1)[1], ] } if (as.character(dat1$Date_collected[1]) == &quot;&quot;) { dat1 = dat1[2:dim(dat1)[1], ] } d = as.numeric(strftime(as.Date(dat1$Date_collected, na.rm = T), format = &quot;%j&quot;)) y = as.numeric(strftime(as.Date(dat1$Date_collected, na.rm = T), format = &quot;%Y&quot;)) rind = which(y &lt;= endyear &amp; y &gt;= startyear) d = d[rind] y = y[rind] crp = colorRampPalette(colors)(round(log10(max(dat1$ct) + 2)) + 1) plotrix::radial.plot(y, (d/366) * 6.28319, rp.type = &quot;s&quot;, start = 1.62, labels = month.abb, clockwise = TRUE, point.col = crp[(round(log10(dat1[,2]) + 2)) - 1], point.symbols = 20, grid.bg = &quot;black&quot;, radial.lim = c(startyear, endyear), cex=ptsize, show.radial.grid = T, show.grid.labels = F, show.grid = T, main = title) } chronohorogram2(sontra_bdvis, startyear = 2015, endyear = 2020, ptsize = 1.5, title = &quot;2015-2020&quot;) 1.5.1.4 S lng ghi nhn theo h vi treemap Kích thc ca tng ô tng ng vi s lng ghi nhn. Màu sc ca ô th hin s lng Chi ca H. Ví d v nhanh s lng ghi nhn theo các H cho nhóm Chim sontra_bdvis %&gt;% filter(class == &quot;Aves&quot;) %&gt;% taxotree() 1.5.2 GGPLOT2 df_soluong &lt;- sontra %&gt;% group_by(class) %&gt;% summarise(Ho = n_distinct(family), Chi = n_distinct(genus), Loai = n_distinct(scientificName), Ghi_nhan = n()) df_soluong class Ho Chi Loai Ghi_nhan Amphibia 6 13 16 182 Aves 35 67 82 445 Mammal 13 18 19 128 Reptilia 9 23 27 145 df_soluong &lt;- df_soluong %&gt;% tidyr::pivot_longer (-class, names_to = &quot;rank&quot;, values_to = &quot;n&quot;) df_soluong class rank n Amphibia Ho 6 Amphibia Chi 13 Amphibia Loai 16 Amphibia Ghi_nhan 182 Aves Ho 35 Aves Chi 67 Aves Loai 82 Aves Ghi_nhan 445 Mammal Ho 13 Mammal Chi 18 Mammal Loai 19 Mammal Ghi_nhan 128 Reptilia Ho 9 Reptilia Chi 23 Reptilia Loai 27 Reptilia Ghi_nhan 145 library(ggplot2) df_soluong &lt;- df_soluong %&gt;% mutate(rank = factor(rank, levels = c(&quot;Ho&quot;,&quot;Chi&quot;,&quot;Loai&quot;,&quot;Ghi_nhan&quot;), labels = c(&quot;H&quot;,&quot;Chi&quot;,&quot;Loài&quot;,&quot;Ghi nhn&quot;))) df_soluong %&gt;% ggplot(aes(x = class, y=n, fill = rank)) + geom_col(position = &#39;dodge&#39;) gg &lt;- df_soluong %&gt;% ggplot(aes(x = class, y=n, fill = rank)) + geom_col(position = position_dodge()) + geom_text(aes(x = class, y=n, label = n ), position = position_dodge(width = 0.9), vjust = -0.5) + scale_fill_viridis_d() + theme_bw() gg gg + labs(title = &quot;S lng ghi nhn, H, Chi và Loài ti Sn Trà&quot;, subtitle = &quot;Nm 2019&quot;, x = &quot;Nhóm&quot;, y = &quot;S lng&quot;, caption = &quot;Ngun d liu : Trn Vn Bng &amp; c.s., 2019&quot;) "],["tra-c-u-c-p-quý-hi-m-c-a-loài-theo-iucn.html", "Chng 2 Tra cu cp  quý him ca loài theo IUCN 2.1 Xin cp và khai báo mã cá nhân t IUCN 2.2 S dng gói taxize 2.3 S dng gói rredlist", " Chng 2 Tra cu cp  quý him ca loài theo IUCN 2.1 Xin cp và khai báo mã cá nhân t IUCN  có th tra cu t ng trên d liu IUCN, ta cn mã token c cp ti a ch https://apiv3.iucnredlist.org/api/v3/token. Mã này c cp riêng cho tng cá nhân. Do ó các bn cn phi bo qun k vì mi ln tra cu thì mã này s c gi và lu vào h thng ca IUCN  qun lý. Sau khi c cp mã token, ta khai báo trong R vi hai cách nh sau. Lu ý thay IUCN_TOKEN bng mã cá nhân ca bn. Cách 1: chèn mã vào option options(iucn_redlist_key=&quot;IUCN_TOKEN&quot;) Cách 2: chèn dòng lnh vi cu trúc IUCN_REDLIST_KEY=\"IUCN_TOKEN\" vào tp tin có tên .Renviron. Nu không tìm thy tp tin này trong máy thì có th s dng dòng lnh usethis::edit_r_environ() trong R  m tp tin này lên. 2.2 S dng gói taxize Gi gói lnh # install.packages(&quot;taxize&quot;) # remotes::install_github(&quot;ropensci/taxize&quot;) library(taxize) S dng lnh iucn_summary()  tra cu thông tin trc tip trên trang web ca IUCN. 2.2.1 Tra cu cho 1 loài Ví d: tra cu cho 1 loài Afzelia xylocarpa: iucn_res &lt;- iucn_summary(&quot;Afzelia xylocarpa&quot;) Kt qu tr v là nh dng list, trong ó cho mi loài là mt phn t. Mi phn t li là mt list khác cha 4 thông tin sau (nu có) : Tình trng nguy cp, lch s xp hng, vùng phân b và xu hng kích thc qun th. Vì chúng ta ch tra cho 1 loài nên ta truy vn trc tip vào phn t u tiên ca kt qu. names(iucn_res[[1]]) ## [1] &quot;status&quot; &quot;history&quot; &quot;distr&quot; &quot;trend&quot; # Tình trng nguy cp iucn_res[[1]]$status ## [1] &quot;EN&quot; # Lch s xp hng iucn_res[[1]]$history year code category 1998 EN Endangered # Quc gia phân b ca loài iucn_res[[1]]$distr ## [1] &quot;Cambodia&quot; &quot;Lao People&#39;s Democratic Republic&quot; ## [3] &quot;Myanmar&quot; &quot;Thailand&quot; ## [5] &quot;Viet Nam&quot; # Xú hng v s phân b ca loài iucn_res[[1]]$trend ## [1] NA 2.2.2 Tra cu cho nhiu loài Hàm iucn_summary() có th áp dng cho vector nhiu phn t.  tra cu cho nhiu loài cùng lúc, ta ch cn gi lnh trên danh sách các loài cn tra cu. mysp &lt;- c(&quot;Afzelia xylocarpa&quot;,&quot;Xylopia pierrei&quot;,&quot;Dipterocarpus dyeri&quot;) iucn_res &lt;- iucn_summary(mysp) Ta có th xem nhanh trng thái ca c 3 loài trên bng lnh iucn_status() iucn_status(iucn_res) ## Afzelia xylocarpa Xylopia pierrei Dipterocarpus dyeri ## &quot;EN&quot; &quot;VU&quot; &quot;EN&quot; 2.3 S dng gói rredlist Bên cnh gói taxize, ta còn có th s dng gói rredlist cho mc ích này. library(rredlist) Tra cu vi lnh rl_search(). Kt qu tr v là 1 list gm 2 phn t : * name: cha tên loài tra cu * result: bng gm 30 trng thông tin liên quan n loài 2.3.1 Tra cu cho 1 loài iucn_res &lt;- rl_search(&quot;Afzelia xylocarpa&quot;) # Xem tên các trng thông tin colnames(iucn_res$result) ## [1] &quot;taxonid&quot; &quot;scientific_name&quot; &quot;kingdom&quot; ## [4] &quot;phylum&quot; &quot;class&quot; &quot;order&quot; ## [7] &quot;family&quot; &quot;genus&quot; &quot;main_common_name&quot; ## [10] &quot;authority&quot; &quot;published_year&quot; &quot;assessment_date&quot; ## [13] &quot;category&quot; &quot;criteria&quot; &quot;population_trend&quot; ## [16] &quot;marine_system&quot; &quot;freshwater_system&quot; &quot;terrestrial_system&quot; ## [19] &quot;assessor&quot; &quot;reviewer&quot; &quot;aoo_km2&quot; ## [22] &quot;eoo_km2&quot; &quot;elevation_upper&quot; &quot;elevation_lower&quot; ## [25] &quot;depth_upper&quot; &quot;depth_lower&quot; &quot;errata_flag&quot; ## [28] &quot;errata_reason&quot; &quot;amended_flag&quot; &quot;amended_reason&quot; # Xem trng thái ca loài iucn_res$result %&gt;% select(scientific_name, category, criteria, published_year) scientific_name category criteria published_year Afzelia xylocarpa EN A1cd 1998 2.3.2 Tra cu cho nhiu loài Hàm rl_search() ch áp dng  tra cu mt loài,  tra cu nhiu loài thì ta cn t trong vòng lp. Ví d: mysp &lt;- c(&quot;Afzelia xylocarpa&quot;,&quot;Xylopia pierrei&quot;,&quot;Dipterocarpus dyeri&quot;) res &lt;- lapply(mysp, rl_search) Xem nhanh kt qu sapply(res, function(x) paste(x$name,&quot;-&quot;, x$result$category)) ## [1] &quot;Afzelia xylocarpa - EN&quot; &quot;Xylopia pierrei - VU&quot; ## [3] &quot;Dipterocarpus dyeri - EN&quot; 2.3.3 Xem quc gia có s phân b ca loài: T s dng lnh rl_occ_country() cho tng loài mun kim tra. Nu mun cho nhiu loài thì cn t trong vòng lp, tng t nh phn trên. rl_occ_country(&#39;Afzelia xylocarpa&#39;) ## $name ## [1] &quot;Afzelia xylocarpa&quot; ## ## $count ## [1] 5 ## ## $result ## code country presence origin distribution_code ## 1 KH Cambodia Extant Native unspecified ## 2 LA Lao People&#39;s Democratic Republic Extant Native unspecified ## 3 MM Myanmar Extant Native unspecified ## 4 TH Thailand Extant Native unspecified ## 5 VN Viet Nam Extant Native unspecified "],["ki-m-tra-danh-pháp-th-c-v-t.html", "Chng 3 Kim tra danh pháp Thc vt 3.1 The Plant list 3.2 WorldFlora 3.3 The Leipzig Catalogue of Vascular Plants", " Chng 3 Kim tra danh pháp Thc vt 3.1 The Plant list S dng gói Taxonstand  tra cu danh pháp trên b d liu The Plant list library(Taxonstand) 3.1.1 Trng hp bình thng  tra cu, chúng ta s dng lnh TPL(). Phn tên loài ta có th  c phn tên tác gi. mysp &lt;- c(&quot;Afzelia xylocarpa (Kurz) Craib&quot;, &quot;Dipterocarpus dyeri&quot;, &quot;Afzelia cochinchinensis&quot;) TPL_res &lt;- TPL(mysp) Bng kt qu có rt nhiu trng thông tin. Trong ó ct Taxonomic.status s cho bit trng thái ca danh pháp. Nu là loài ng danh thì ta có th xem tên loài c chp nhn  các ct New.Genus, New.Species, New.Authority. colnames(TPL_res) ## [1] &quot;Taxon&quot; &quot;Genus&quot; &quot;Hybrid.marker&quot; ## [4] &quot;Species&quot; &quot;Abbrev&quot; &quot;Infraspecific.rank&quot; ## [7] &quot;Infraspecific&quot; &quot;Authority&quot; &quot;ID&quot; ## [10] &quot;Plant.Name.Index&quot; &quot;TPL.version&quot; &quot;Taxonomic.status&quot; ## [13] &quot;Family&quot; &quot;New.Genus&quot; &quot;New.Hybrid.marker&quot; ## [16] &quot;New.Species&quot; &quot;New.Infraspecific.rank&quot; &quot;New.Infraspecific&quot; ## [19] &quot;New.Authority&quot; &quot;New.ID&quot; &quot;New.Taxonomic.status&quot; ## [22] &quot;Typo&quot; &quot;WFormat&quot; &quot;Higher.level&quot; ## [25] &quot;Date&quot; &quot;Tax_res&quot; Ta xem mt vài trng thông tin chính TPL_res %&gt;% select(Taxon, Taxonomic.status, Family, New.Genus, New.Species, New.Authority) Taxon Taxonomic.status Family New.Genus New.Species New.Authority Afzelia xylocarpa (Kurz) Craib Accepted Leguminosae Afzelia xylocarpa (Kurz) Craib Dipterocarpus dyeri Accepted Dipterocarpaceae Dipterocarpus dyeri Pierre ex Laness. Afzelia cochinchinensis Synonym Leguminosae Afzelia xylocarpa (Kurz) Craib 3.1.2 Trng hp sai li chính t trong danh pháp Nu tên loài tra cu sai li chính t thì lnh TPL vn tra cu và gi ý tên loài chính xác, ng thi s ch ra tên loài nào b li  ct Typo. Mc nh hàm s gi ý tên loài vi gii hn 2 ký t khác bit. Ta thêm tham s diffchar = n  thit lp s ký t khác bit theo nhu cu. Nu s n càng ln thì thi gian tra cu s tng lên. mysp &lt;- c(&quot;Afzelia xylocarpa&quot;,&quot;Afzelia xylocarppa&quot;,&quot;Afzellia xylocarppa&quot;) TPL(mysp) %&gt;% select(Taxon, Taxonomic.status, Typo, New.Genus, New.Species) Taxon Taxonomic.status Typo New.Genus New.Species Afzelia xylocarpa Accepted FALSE Afzelia xylocarpa Afzelia xylocarppa Accepted TRUE Afzelia xylocarpa Afzellia xylocarppa Accepted TRUE Afzelia xylocarpa 3.2 WorldFlora Bên cnh TPL ta có th tra cu vi b WorldFlora library(WorldFlora) Nu ln u tiên cài t thì ta cn chy lnh WFO.download()  ti toàn b d liu v máy. Lnh s t ng lu b d liu này vào bng tên WFO.data. # download the Taxonomic Backbone data WFO.download() Nu chúng ta ã ti ri thì ch cn chy lnh WFO.remember()  m li b d liu. Mc nh nó s nh v trí ca ln ti trc ó. Ta có th s dng tham s WFO.file =  ch nh chính xác n b d liu ã ti. # remember the previous download and avail the data as &#39;WFO.data&#39; WFO.remember() WFO.remember(WFO.file = &quot;data/WFO_Backbone/classification.txt&quot;) 3.2.1 Trng hp bình thng Ta s dng lnh WFO.match()  tra cu. Kt qu tr v cng có rt nhiu trng thông tin. Ta xem trên mt s trng thông tin chính mysp &lt;- c(&quot;Afzelia xylocarpa&quot;,&quot;Dipterocarpus dyeri&quot;, &quot;Afzelia cochinchinensis&quot;) WFO.match(spec.data = mysp, WFO.data = WFO.data) %&gt;% select(spec.name.ORIG, family, scientificName, scientificNameAuthorship, taxonomicStatus, Old.status) spec.name.ORIG family scientificName scientificNameAuthorship taxonomicStatus Old.status Afzelia xylocarpa Fabaceae Afzelia xylocarpa (Kurz) Craib Accepted Dipterocarpus dyeri Dipterocarpaceae Dipterocarpus dyeri Pierre ex Laness. Accepted Afzelia cochinchinensis Fabaceae Afzelia xylocarpa (Kurz) Craib Accepted Synonym 3.2.2 Trng hp sai li chính t trong danh pháp Tng t nh lnh TPL(), lnh WFO.match() cng s gi ý tên úng cho các danh pháp sai li chính t. Nu tên loài b sai và c gi ý tên mi thì s c ghi li thông tin trên ct Fuzzy ca bng kt qu. # check mysp &lt;- c(&quot;Afzelia xylocarpa&quot;,&quot;Afzelia xylocarppa&quot;,&quot;Afzellia xylocarppa&quot;) WFO.match(spec.data = mysp, WFO.data = WFO.data) %&gt;% select(spec.name.ORIG, family, scientificName, scientificNameAuthorship, taxonomicStatus) spec.name.ORIG Fuzzy family scientificName scientificNameAuthorship taxonomicStatus Afzelia xylocarpa FALSE Fabaceae Afzelia xylocarpa (Kurz) Craib Accepted Afzelia xylocarppa TRUE Fabaceae Afzelia xylocarpa (Kurz) Craib Accepted Afzellia xylocarppa TRUE Fabaceae Afzelia xylocarpa (Kurz) Craib Accepted 3.2.3 Xem thông tin v H, B, Nhóm t tên loài Ta s dng lnh WFO.family()  tra cu. WFO.family(&quot;Dipterocarpus dyeri&quot;, WFO.data=WFO.data) Group Family Order Node.1 Node.2 Node.3 Node.4 253 angiosperms Dipterocarpaceae Malvales Eudicots Superrosids Rosids Malvids 3.2.4 Xem danh sách các danh pháp ca mt loài S dng WFO.synonyms  xem tt c danh pháp ng danh ca mt loài. Ta có th tra cu trên danh pháp c chp nhn hoc ng danh u c. # give synonyms WFO.synonyms(&quot;Afzelia xylocarpa&quot;, WFO.data=WFO.data) taxonID scientificName scientificNameAuthorship taxonRank taxonomicStatus acceptedNameUsageID 1 wfo-0000186209 Afzelia xylocarpa (Kurz) Craib SPECIES Accepted 1049459 wfo-0001057574 Afzelia cochinchinensis (Pierre) J.Léonard SPECIES Synonym wfo-0000186209 200014 wfo-0000203530 Afzelia siamica Craib SPECIES Synonym wfo-0000186209 194035 wfo-0000197126 Pahudia cochinchinensis Pierre SPECIES Synonym wfo-0000186209 194034 wfo-0000197125 Pahudia xylocarpa Kurz SPECIES Synonym wfo-0000186209 3.2.5 Xem danh sách các loài trong mt chi S dng lnh WFO.browse()  ly danh sách các loài trong mt chi nào ó. Nu ch mun ly các danh pháp c chp nhn, ta s dng tham s accepted.only=TRUE. WFO.browse(&quot;Afzelia&quot;, WFO.data=WFO.data, accepted.only=TRUE) scientificName scientificNameAuthorship taxonRank taxonomicStatus acceptedNameUsageID Afzelia africana Pers. SPECIES Accepted Afzelia bella Harms SPECIES Accepted Afzelia bipindensis Harms SPECIES Accepted Afzelia bracteata Benth. SPECIES Accepted Afzelia javanica (Miq.) J.Leonard SPECIES Accepted Afzelia martabanica (Prain) J.Leonard SPECIES Accepted Afzelia pachyloba Harms SPECIES Accepted Afzelia parviflora (Vahl) Hepper SPECIES Accepted Afzelia peturei De Wild. SPECIES Accepted Afzelia quanzensis Welw. SPECIES Accepted Afzelia rhomboidea (Blanco) S.Vidal SPECIES Accepted Afzelia xylocarpa (Kurz) Craib SPECIES Accepted Tuy nhiên vic tra cu bng lnh này khá lâu, ta có th thao tác trc tip trên d liu nh sau: WFO.data %&gt;% filter(genus == &quot;Afzelia&quot;, taxonomicStatus == &quot;Accepted&quot;) %&gt;% select(family, scientificName, scientificNameAuthorship) family scientificName scientificNameAuthorship Fabaceae Afzelia xylocarpa (Kurz) Craib Fabaceae Afzelia martabanica (Prain) J.Leonard Fabaceae Afzelia javanica (Miq.) J.Leonard Fabaceae Afzelia rhomboidea (Blanco) S.Vidal Fabaceae Afzelia bella Harms Fabaceae Afzelia bipindensis Harms Fabaceae Afzelia bracteata Benth. Fabaceae Afzelia pachyloba Harms Fabaceae Afzelia peturei De Wild. Fabaceae Afzelia quanzensis Welw. Fabaceae Afzelia africana Pers. Fabaceae Afzelia parviflora (Vahl) Hepper 3.2.6 Tách phn tên tác gi và phn tên loài S dng lnh WFO.prepare()  tách phn tên tác gi và tên loài. mysp &lt;- c(&quot;Afzelia javanica (Miq.) J.Leonard (**) (In review)&quot;, &quot;Sorbus aucuparia subsp. praemorsa (Guss.) Nyman&quot;) mysp %&gt;% WFO.prepare() %&gt;% select(spec.full, spec.name, Authorship) spec.full spec.name Authorship Afzelia javanica (Miq.) J.Leonard (**) (In review) Afzelia javanica (Miq.) J.Leonard Sorbus aucuparia subsp. praemorsa (Guss.) Nyman Sorbus aucuparia subsp. praemorsa (Guss.) Nyman 3.3 The Leipzig Catalogue of Vascular Plants devtools::install_github(&quot;idiv-biodiversity/lcvplants&quot;) devtools::install_github(&quot;idiv-biodiversity/LCVP&quot;) library(lcvplants) 3.3.1 Trng hp bình thng S dng lnh LCVP()  kim tra danh lc mysp &lt;- c(&quot;Afzelia xylocarpa&quot;,&quot;Dipterocarpus dyeri&quot;, &quot;Afzelia cochinchinensis&quot;) LCVP(splist = mysp) %&gt;% select(Submitted_Name:Species, Authors, Status, LCVP_Accepted_Taxon) Submitted_Name Order Family Genus Species Authors Status LCVP_Accepted_Taxon Afzelia xylocarpa Fabales Fabaceae Afzelia xylocarpa (Kurz) Craib accepted Afzelia xylocarpa (Kurz) Craib Dipterocarpus dyeri Malvales Dipterocarpaceae Dipterocarpus dyeri Pierre ex Laness. accepted Dipterocarpus dyeri Pierre ex Laness. Afzelia cochinchinensis Fabales Fabaceae Afzelia cochinchinensis (Pierre) J.Léonard synonym Afzelia xylocarpa (Kurz) Craib 3.3.2 Trng hp sai li chính t trong danh pháp S dng thêm max.distance  thit lp s ký t cho phép sai lch vi tên úng khi kim tra danh lc. Tham s genus_search  thc hin vic kim tra li cho c ct chi. mysp &lt;- c(&quot;Afzelia xylocarpa&quot;,&quot;Afzelia xylocarppa&quot;,&quot;Afzellia xylocarppa&quot;) LCVP(splist = mysp, max.distance = 1, genus_search = TRUE) %&gt;% select(Score, Submitted_Name:Species, Authors, Status, LCVP_Accepted_Taxon) Score Submitted_Name Order Family Genus Species Authors Status LCVP_Accepted_Taxon matched Afzelia xylocarpa Fabales Fabaceae Afzelia xylocarpa (Kurz) Craib accepted Afzelia xylocarpa (Kurz) Craib misspelling: Epithet Afzelia xylocarppa Fabales Fabaceae Afzelia xylocarpa (Kurz) Craib accepted Afzelia xylocarpa (Kurz) Craib misspelling: Genus, Epithet Afzellia xylocarppa Fabales Fabaceae Afzelia xylocarpa (Kurz) Craib accepted Afzelia xylocarpa (Kurz) Craib Ct Score trong bng kt qu s cho bit danh pháp có b sai chính t hay không và sai  phn nào. 3.3.3 Xem danh sách tên loài ca mt chi LCVP(&quot;Dipterocarpus&quot;, genus_tab = TRUE) %&gt;% select(Genus, LCVP_Accepted_Taxon, Status) 3.3.4 Xem danh sách các loài ph ca mt loài LCVP(&quot;Atriplex cinerea&quot;, infra_specific = TRUE) "],["ki-m-tra-danh-pháp-ng-v-t.html", "Chng 4 Kim tra danh pháp ng vt 4.1 Kim tra và chnh sa danh pháp 4.2 Kim tra s ng danh 4.3 Xem thông tin v loài 4.4 Tìm các cp phân loi t tên loài 4.5 Xem danh sách các tên ng danh ca mt loài vi b d liu EOL 4.6 Xem danh sách tt c các taxa con ca mt taxon", " Chng 4 Kim tra danh pháp ng vt S dng gói taxize library(taxize) 4.1 Kim tra và chnh sa danh pháp u tiên ta cn xác nh mã ID ca ngun d liu cn dùng  tra cu trong danh sách các ngun c h tr ca gói lnh. S dng lnh gnr_datasources()  xem danh sách các ngun. Tùy i tng nghiên cu ta s chn ngun d liu thích hp. sources &lt;- gnr_datasources() Trong ví d này ta s chn ngun tham kho là Integrated Taxonomic Information SystemITIS. ITIS &lt;- sources %&gt;% filter(title == &#39;Integrated Taxonomic Information SystemITIS&#39;) %&gt;% .$id Ta có mt danh lc gm 5 loài, trong ó loài Sus scroffa b sai li chính t  ch f. S dng lnh gnr_resolve()  kim tra danh pháp vi b d liu ITIS. S dng tham s canonical = TRUE s tr v tên khoa hc úng và không cha phn tên tác gi. Nu ta cn c phn tên tác gi thì  giá tr là FALSE. mysp &lt;- c(&quot;Herpestes javanicus&quot;, &quot;Sus domesticus&quot;, &quot;Sus scroffa&quot;, &quot;Actitis hypoleucos&quot;,&quot;Tringa hypoleucos&quot;) mysp_checked &lt;- gnr_resolve(sci = mysp, data_source_ids = ITIS , canonical = TRUE) %&gt;% dplyr::select(submitted_name, matched_name2) mysp_checked submitted_name matched_name2 Herpestes javanicus Herpestes javanicus Sus domesticus Sus domesticus Sus scroffa Sus scrofa Actitis hypoleucos Actitis hypoleucos Tringa hypoleucos Tringa hypoleucos Kt qu c 5 loài u c tìm thy trong d liu tra cu. Và loài Sus scroffa ã c sa li chính t vi tên úng Sus scrofa 4.2 Kim tra s ng danh Ta s dng lnh get_tsn()  ly mã id ca loài ã c kim tra  bc trên (ct matched_name2) trong b d liu. mysp_checked$id &lt;- get_tsn(mysp_checked$matched_name2) %&gt;% as.character() mysp_checked submitted_name matched_name2 id Herpestes javanicus Herpestes javanicus 552467 Sus domesticus Sus domesticus 898265 Sus scroffa Sus scrofa 180722 Actitis hypoleucos Actitis hypoleucos 176613 Tringa hypoleucos Tringa hypoleucos 176625 Sau khi ã có mã id ca danh pháp, ta có th s dng lnh id2name()  xem tình trng danh pháp có hiu lc hay không. check_status &lt;- id2name(mysp_checked$id, db = &quot;itis&quot;) do.call(rbind, check_status ) id name rank status parent_tsn 552467 552467 Herpestes javanicus Species valid 180612 898265 898265 Sus domesticus Species invalid 0 180722 180722 Sus scrofa Species valid 180721 176613 176613 Actitis hypoleucos Species valid 176611 176625 176625 Tringa hypoleucos Species invalid 0 Ct status cho thy có 2 tên loài trong danh pháp không còn hiu lc. ây có th là tên ng danh. Ta dùng lnh itis_acceptname()  kim tra danh sách tên loài này có cha tên ng danh hay không da trên ct id. Nu là tên ng danh thì lnh s tr v tên c chp nhn  ct acceptedname. check_syn &lt;- itis_acceptname(searchtsn = mysp_checked$id) check_syn submittedtsn acceptedname acceptedtsn author 552467 NA 552467 NA 898265 Sus scrofa 180722 Linnaeus, 1758 180722 NA 180722 NA 176613 NA 176613 NA 176625 Actitis hypoleucos 176613 (Linnaeus, 1758) Kt qu ta thy có 2 tên ng danh trong danh lc. Ta có th ghép kt qu này vào bng mysp_checked bng lnh left_join() nh sau mysp_checked &lt;- left_join(mysp_checked, check_syn, by = c(&quot;id&quot; = &quot;submittedtsn&quot;)) mysp_checked submitted_name matched_name2 id acceptedname acceptedtsn author Herpestes javanicus Herpestes javanicus 552467 NA 552467 NA Sus domesticus Sus domesticus 898265 Sus scrofa 180722 Linnaeus, 1758 Sus scroffa Sus scrofa 180722 NA 180722 NA Actitis hypoleucos Actitis hypoleucos 176613 NA 176613 NA Tringa hypoleucos Tringa hypoleucos 176625 Actitis hypoleucos 176613 (Linnaeus, 1758) 4.3 Xem thông tin v loài Ct acceptedtsn  bng trên cha mã id ca tt c danh pháp c chp nhn. T ct này ta có th ly tt c các thông tin khác ca loài vi lnh itis_getrecord() Ví d ly thông tin v loài Herpestes javanicus có mã id là 552467 itis_getrecord(552467) Vì kt qu ca hàm này rt dài nên tôi không th hin  ây. Các bn có th thc hàng và xem kt qu trên máy tính ca mình. Ta có th vit mt lnh nh ch  ly phn tên loài và tên tác gi t id nh sau: itis_id2name_author &lt;- function(id){ df &lt;- itis_getrecord(id) %&gt;% lapply(function(x) x$scientificName) res &lt;- data.frame(tsn = sapply(df, function(x) x$tsn), combinedName = sapply(df, function(x) x$combinedName), author = sapply(df, function(x) x$author)) return(res) } itis_id2name_author(mysp_checked$acceptedtsn) tsn combinedName author 552467 Herpestes javanicus (É. Geoffroy Saint-Hilaire, 1818) 180722 Sus scrofa Linnaeus, 1758 180722 Sus scrofa Linnaeus, 1758 176613 Actitis hypoleucos (Linnaeus, 1758) 176613 Actitis hypoleucos (Linnaeus, 1758) 4.4 Tìm các cp phân loi t tên loài S dng lnh tax_name(). Nhp các cp phân loi cn ly thông tin vào tham s get =. Lnh này s dng hai ngun d liu tra cu là ITIS và NCBI. Thay i tham s db = itis hoc ncbi hoc both  chn ngun d liu cn tra. mysp &lt;- c(&quot;Herpestes javanicus&quot;, &quot;Sus scrofa&quot;, &quot;Actitis hypoleucos&quot;) tax_name(mysp, db = &quot;itis&quot;, get = c(&quot;genus&quot;,&quot;family&quot;,&quot;order&quot;,&quot;class&quot;,&quot;kingdom&quot;), messages = F) db query kingdom class order family genus itis Herpestes javanicus Animalia Mammalia Carnivora Herpestidae Herpestes itis Sus scrofa Animalia Mammalia Artiodactyla Suidae Sus itis Actitis hypoleucos Animalia Aves Charadriiformes Scolopacidae Actitis Xem danh sách các cp phân loi có trong b d liu: rank_ref$ranks ## [1] &quot;domain; superkingdom; kingdom; subkingdom; infrakingdom,superphylum; phylum,division; subphylum,subdivision; infradivision; superclass; class; subclass; infraclass; subterclass; parvclass; megacohort; supercohort; cohort; subcohort; infracohort; superorder; order; suborder; infraorder; parvorder; superfamily; family; subfamily; supertribe; tribe; subtribe; genus; subgenus; section; subsection; species group,series; species subgroup; species; infraspecies; subspecies,forma specialis; variety,varietas; subvariety,race; stirp; form,forma,morph; subform; biotype,isolate,pathogroup,serogroup,serotype,strain,aberration; unspecified,no rank,unranked,clade&quot; 4.5 Xem danh sách các tên ng danh ca mt loài vi b d liu EOL S dng lnh eol_search()  ly thông tin ID ca loài cn kim tra trong b d liu EOL. Sau ó s dng lnh eol_pages()  ly danh sách các tên loài ng danh ca loài. Ví d: Ly danh sách tên ng danh ca Fejervarya limnocharis # Xác nh ID taxonID &lt;- eol_search(sci=&#39;Fejervarya limnocharis&#39;) # ly thông tin eol_pages(taxonconceptID = taxonID$pageid, synonyms = TRUE) %&gt;% .$synonyms 4.6 Xem danh sách tt c các taxa con ca mt taxon S dng lnh downstream() vi tham s downto =  xác nh cp phân loi gn ly danh sách. Thay i tham s db = vi b d liu cn tra cu: itis, ncbi, worms, hoc bold Ví d ly danh sách chi ca h Suidae res &lt;- downstream(&#39;Suidae&#39;, db=&quot;itis&quot;, downto=&quot;genus&quot;) res$Suidae tsn parentname parenttsn rankname taxonname rankid 180721 Suini 898083 genus Sus 180 624935 Babyrousini 898084 genus Babyrousa 180 624936 Phacochoerini 898085 genus Phacochoerus 180 624937 Potamochoerini 898086 genus Hylochoerus 180 624938 Potamochoerini 898086 genus Potamochoerus 180 Ví d ly danh sách các loài ca h Suidae res &lt;- downstream(&#39;Suidae&#39;, db=&quot;itis&quot;, downto=&quot;species&quot;) res$Nymphaeaceae Ví d ly danh sách loài ca chi Sus res = downstream(&#39;Sus&#39;, db=&quot;itis&quot;, downto=&quot;species&quot;) res$Sus Ta có th nhp các cp phân loi sau vào tham s downto = : 'superkingdom', 'kingdom', 'subkingdom','infrakingdom','phylum','division','subphylum', 'subdivision','infradivision', 'superclass','class','subclass','infraclass', 'superorder','order','suborder','infraorder','superfamily','family', 'subfamily','tribe','subtribe','genus','subgenus','section','subsection', 'species group','species','subspecies','variety','form','subvariety','race', 'stirp', 'morph','aberration','subform', 'unspecified', 'no rank' "]]
